!function(d){var l={},m=dbmovies.ajaxurl,i=dbmovies.dapiurl,r=dbmovies.tapiurl,n=dbmovies.dapikey,c=dbmovies.tapikey,p=dbmovies.apilang,a=dbmovies.safemod,o=dbmovies.extimer,s=dbmovies.inscrll,v=dbmovies.rscroll,e=dbmovies.csectin,b=dbmovies.nocrdt,u=dbmovies.gerepis,t=navigator.onLine,g="#dbmovies-generartor",h="#dbmovies-updaterpost",f="#dbmovies-json-response",_="#dbmovies-importer",C="#dbmovies-generator-seasons",k="#dbmovies-generator-episodes",y="#dbmovies-imdb-updater-page";d(function(){l.GenerateSeEp(),l.PostGenerateSeEp(),l.GenerateAllEpisodesGet(),l.UpdaterEditorPost(),l.GenerateEditor(),l.NavSettings(),l.SaveSettings(),l.GoTop(),l.LogCollapse(),l.Auth(),l.IMDbUpdater(),l.CodeStarTab(),l.Application(),l.Search(),l.Filter(),l.LoadMore(),l.Importer(),l.Cimport(),l.GeneratorSeasons(),l.GeneratorEpisodes(),l.ReubicateForm(),l.LogCleaner(),l.InternetCon(),l.Dashboard(),l.MetaUpdater()}),l.MetaUpdater=function(){var e,s,t,a="dbmovies_metaupdater",o="#dbmvs-metaupdater";StatusMU="#dbmvs-metaupdater-status",Proccess="#meta-updater-process",MControl="#meta-updater-controls",MtUPause="#meta-updater-pause",RunMTUpT="#meta-updater-run",1!=o.length&&(e=l.getCookie("_dbmvs_metaupdater_status"),s=l.getCookie("_dbmvs_metaupdater_progress"),t=l.getCookie("_dbmvs_metaupdater_running"),"paused"==e&&(d(StatusMU).val(s),d(Proccess).show(),d(Proccess+"> span.spinner").hide(),d(Proccess+"> .proccess-bar > .into").addClass("flashit"),d(Proccess+"> span.percentage").text(l.NumberFormat(s)+" %"),d(RunMTUpT).hide(),d(MtUPause).hide(),d(MControl).show(),d(Proccess+"> .proccess-bar > .into").animate({width:s+"%"},150,function(){})),1==t&&"paused"!=e&&(d(Proccess+"> span.percentage").text(l.NumberFormat(s)+" %"),d(Proccess+"> .proccess-bar > .into").animate({width:s+"%"},1e3,function(){}),setTimeout(function(){d(o).trigger("click")},1e3)),d(document).on("click","#dbmvs-finish-metaupdater",function(){var e=d(this).data("control");return confirm("You are about to interrupt the process")&&(d(MtUPause).hide(),d(Proccess).hide(),d(MControl).hide(),d(RunMTUpT).show(),d(Proccess+"> span.spinner").show(),d(Proccess+"> .proccess-bar > .into").removeClass("flashit"),d(StatusMU).val("progress"),d.ajax({url:m,type:"POST",dataType:"json",data:{action:a,process:e},success:function(e){l.delCookie("_dbmvs_metaupdater_running"),l.delCookie("_dbmvs_metaupdater_status"),l.delCookie("_dbmvs_metaupdater_progress"),d("#dbmvs-log-indicator").after('<li class="shake"><span class="type error">dbmvs</span>'+e.message+"</li>")}})),!1}),d(document).on("click",o,function(){var e=d(StatusMU).val(),s=d(this).data("control");return"progress"==e&&(d(MtUPause).show(),d(Proccess).show(),d(RunMTUpT).hide(),d.ajax({url:m,type:"POST",dataType:"json",data:{action:a,process:s},success:function(e){1==e.success?(d(o).trigger("click"),d(Proccess+"> .proccess-bar > .into").animate({width:e.progress+"%"},150,function(){}),d(Proccess+"> span.percentage").text(l.NumberFormat(e.progress)+" %"),l.setCookie("_dbmvs_metaupdater_progress",e.progress,30),l.setCookie("_dbmvs_metaupdater_running",1,30),l.ComposeItemLog(e.content)):(l.delCookie("_dbmvs_metaupdater_running"),l.delCookie("_dbmvs_metaupdater_status"),l.delCookie("_dbmvs_metaupdater_progress"),d(Proccess+"> .proccess-bar > .into").animate({width:"0%"},800,function(){}),setTimeout(function(){d(MtUPause).hide(),d(Proccess).hide(),d(MControl).hide(),d(RunMTUpT).show(),d(Proccess+"> span.spinner").show(),d(Proccess+"> .proccess-bar > .into").removeClass("flashit"),d(StatusMU).val("progress")},1e3))}})),!1}),d(document).on("click",".metaupdater-control",function(){switch(d(this).data("control")){case"continue":d(MControl).hide(),d(MtUPause).show(),d(Proccess+"> span.spinner").show(),d(Proccess+"> .proccess-bar > .into").removeClass("flashit"),d(StatusMU).val("progress"),l.setCookie("_dbmvs_metaupdater_status","progress",30),setTimeout(function(){d(o).trigger("click")},500);break;case"finish":break;case"pause":d(Proccess+"> span.spinner").hide(),d(Proccess+"> .proccess-bar > .into").addClass("flashit"),d(MtUPause).hide(),d(MControl).show(),d(StatusMU).val("paused"),l.setCookie("_dbmvs_metaupdater_status","paused",30)}return!1}))},l.TimeSince=function(e){var s=Math.floor((Date.now()-e)/1e3),t=dbmovies.timest.seconds;s<0&&(s=-s);var a=s;return 31536e3<=s?t=1!=(a=Math.floor(s/31536e3))?dbmovies.timest.years:dbmovies.timest.year:2592e3<=s?t=1!=(a=Math.floor(s/2592e3))?dbmovies.timest.months:dbmovies.timest.month:604800<=s?t=1!=(a=Math.floor(s/604800))?dbmovies.timest.weeks:dbmovies.timest.week:86400<=s?t=1!=(a=Math.floor(s/86400))?dbmovies.timest.days:dbmovies.timest.day:3600<=s?t=1!=(a=Math.floor(s/3600))?dbmovies.timest.hours:dbmovies.timest.hour:60<=s&&(t=1!=(a=Math.floor(s/60))?dbmovies.timest.minutes:dbmovies.timest.minute),a+" "+t},l.Dashboard=function(){var a=d("#dbmovies-inboxes-nonce").val();1==d("#dooplay_dashboard_widget").length&&(1==dbmovies.formrpt?(d("#doodashcont-reported-click").addClass("active"),d("#doodashcont-reported").addClass("on")):1==dbmovies.formcot&&0==dbmovies.formrpt&&(d("#doodashcont-reported-click").remove(),d("#doodashcont-reported").remove(),d("#doodashcont-inbox-click").addClass("active"),d("#doodashcont-inbox").addClass("on")),0==dbmovies.formcot&&(d("#doodashcont-inbox-click").remove(),d("#doodashcont-inbox").remove())),d(document).on("click",".dooplay-dashaboard-navigation",function(){var e=d(this).attr("data-id");e&&(d(".dooplay-dashaboard-navigation").removeClass("active"),d(this).addClass("active"),d(".dashcont").removeClass("on"),d("#doodashcont-"+e).addClass("on"))}),1==d("#response-inboxes-report").length&&1==dbmovies.formrpt&&l.GetDataInboxes("report",1,a),1==d("#response-inboxes-contact").length&&1==dbmovies.formcot&&l.GetDataInboxes("contact",1,a),d(document).on("click",".inboxes-loadmore",function(){var e=d(this).data("type"),s=d("#inboxes-input-"+e).val();return l.GetDataInboxes(e,s,a),!1}),d(document).on("click",".close-inboxes",function(){var e=d(this).data("type"),s="#post-"+d(this).data("id")+"-"+e;return 1==d(s+" > div.message").length&&(d(s).removeClass("reading"),d(s).addClass("read"),d(s+" > .message").remove()),!1}),d(document).on("click",".inboxes-readme-message.unread",function(){var e="#response-count-"+d(this).data("type")+"-unread",s=parseInt(d(e).text());d(e).text(s-1),d(e+"-span").text("("+(s-1)+")")}),d(document).on("click",".inboxes-delete-post",function(){var s=d(this).data("type"),e=d(this).data("id"),t="#post-"+e+"-"+s;return d(t).hide(),d.ajax({url:m,type:"POST",dataType:"json",data:{action:"dbmovies_inboxes_deleting",post:e,type:s,nonce:a},success:function(e){1==e.success?(d(t).remove(),d("#response-count-"+s+"-unread-span").text("("+e.unread+")"),d("#response-count-"+s+"-unread").text(e.unread),d("#response-count-"+s+"-total").text(e.total),0==e.total&&d("#response-inboxes-"+s+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>")):d(t).show()}}),!1}),d(document).on("click",".inboxes-readme-message",function(){var e=d(this).data("type"),s=d(this).data("id"),t="#post-"+s+"-"+e;return d(this).removeClass("unread"),d(this).addClass("read"),1!=d(t+" > div.message").length?(d("#response-inboxes-"+e+" > .item > .message").remove(),d("#response-inboxes-"+e+" > .item").removeClass("reading"),d(t).removeClass("unread"),d(t).addClass("reading"),d(t+" > h4").after('<div class="message"><div class="onload"></div></div>'),d.ajax({url:m,type:"POST",dataType:"html",data:{action:"dbmovies_inboxes_reading",type:e,post:s,nonce:a},success:function(e){d(t).addClass("read"),d(t+" > .message").addClass("fadein"),d(t+" > .message").html(e)}})):(d(t+" > .message").removeClass("fadein"),d(t+" > .message").addClass("shake"),setTimeout(function(){d(t+" > .message").removeClass("shake")},800)),!1})},l.GetDataInboxes=function(r,s,e){d.getJSON(m+"/?action=dbmovies_inboxes&type="+r+"&page="+s+"&nonce="+e,function(e){d("#response-count-"+r+"-unread-span").text("("+e.unread+")"),d("#response-count-"+r+"-unread").text(e.unread),d("#response-count-"+r+"-total").text(e.total);var n=[];d("#response-inboxes-"+r+" > .onload").remove(),e.posts&&(d.each(e.posts,function(e,s){var t='<div id="post-'+s.ID+"-"+r+'" class="fadein item '+s.post_status+'" data-id="'+s.ID+'">',a='<a href="#" class="inboxes-delete-post" data-id="'+s.ID+'" data-type="'+r+'"><i class="dashicons dashicons-trash"></i></a>',o='<span class="date">'+l.TimeSince(new Date(s.post_date))+"</span>",i='<a href="#" data-id="'+s.ID+'" data-type="'+r+'" class="inboxes-readme-message '+s.post_status+'">'+s.post_title+"</a></h4></div>";n.push(t+'<h4 class="title"><i class="dashicons dashicons-email"></i>'+a+o+i)}),d("#response-inboxes-"+r+" > .hidden").before(n.join("")),e.pages>s?(d("#inboxes-paginator-"+r).removeClass("hidden"),d("#inboxes-input-"+r).val(Math.floor(parseInt(s)+1))):d("#inboxes-paginator-"+r).addClass("hidden")),0==e.total&&d("#response-inboxes-"+r+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>"),e.error&&d("#response-inboxes-"+r+" > .hidden").before('<div class="inboxes-notice"><p>'+e.error+"</p></div>")})},l.InternetCon=function(){t||console.log("No hay conexion a Internet")},l.LogCleaner=function(){Cleaner="#dbmovies-cleanlog",d(document).on("click",Cleaner,function(){return d(Cleaner).html(dbmovies.cleangn),setTimeout(function(){d("#dbmovies-logs-box > ul").html('<i id="dbmvs-log-indicator"></i><li class="jump"><span class="type">dbmvs</span>'+dbmovies.cllogs+"</li>"),d(Cleaner).html(dbmovies.cleancl)},200),!1})},l.GenerateSeEp=function(){d(document).on("click","#dbmvseaepbtncl",function(){var e=d("#dbmvgsepare").val();return d("#dbgesbtn_"+e).show(),d("#dbmvs_seaepi_generator").hide(),setTimeout(function(){d("#dbmvseaepbtncl").addClass("hidden"),d("#dbmvseaepico").removeClass("done"),d("#dbmvseaepico").addClass("loading"),d("#dbmvseaeprgrs").removeClass("flashit"),d("#dbmvgseitem").val("1"),d("#dbmvgsetmdb").val(""),d("#dbmvgsetotl").val(""),d("#dbmvgsepare").val(""),d("#dbmvgsetype").val(""),d("#dbmvgsename").val(""),d("#dbmvgseseas").val("")},700),!1}),d(document).on("click",".dbmvsarchiveseep",function(){var s,t,a,o;return n&&(d(this).hide(),d("#dbmvs_seaepi_generator").show(),s=d(this).data("parent"),t=d(this).data("tmdb"),a=d(this).data("season"),o=d(this).data("type"),d.getJSON(i+"/?auth="+n,function(e){d("#dbmvgsepare").val(s),d("#dbmvgsetmdb").val(t),d("#dbmvgsetype").val(o),d("#dbmvgseseas").val(a),(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited)&&d.getJSON(r+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){var s=e.name?e.name:e.original_name;switch(d("#dbmvgsename").val(s),o){case"seasons":d("#dbmvgsetotl").val(e.number_of_seasons);break;case"episodes":d.each(e.seasons,function(e,s){a==s.season_number&&d("#dbmvgsetotl").val(s.episode_count)})}d("#dbmvseaeptxt").html(""),d("#dbmvseaeprgrs").show(),d("#dbmvseaeprgrs").addClass("flashit"),d("#dbmvseaepbtncl").removeClass("hidden"),d("#dbmvseaepico").removeClass("loading"),d("#dbmvseaepico").addClass("done"),d("#dbmvseaepbtn").prop("disabled",!1)})})),!1})},l.PostGenerateSeEp=function(){d(document).on("submit","#dbmvseaepigenerator",function(){var t=d("#dbmvgsepare").val(),a=d("#dbmvgsetmdb").val(),o=parseInt(d("#dbmvgseitem").val()),i=parseInt(d("#dbmvgsetotl").val()),n=o/i*100;return d("#dbmvseaepbtn").hide(),d("#dbmvseaepbtncl").addClass("hidden"),d("#dbmvseaeprgrs").removeClass("flashit"),d("#dbmvseaepico").removeClass("done"),d("#dbmvseaepico").addClass("loading"),d("#dbmvseaeptxt").addClass("flashit"),d("#dbmvseaeptxt").html(dbmovies.loading),d("#gnrtse_"+t).html(dbmovies.prsseng),d.ajax({url:m,type:"POST",dataType:"json",data:d(this).serialize(),success:function(e){var s;d("#dbmvgseitem").val(o+1),1==e.response?(s=o+" / "+i+" >> "+e.title+" >> "+e.mtime,console.log(s),d("#dbmvgseconsolelog").html(s),d("#dbmvseaeprgrs > span").animate({width:n+"%"},150,function(){}),o<i?setTimeout(function(){d("#dbmvseaepbtn").trigger("click")},100):l.PostGenerateSeEpFix(t,a)):l.PostGenerateSeEpFix(t,a)}}),!1})},l.PostGenerateSeEpFix=function(e,s){setTimeout(function(){d("#dbmvgseconsolelog").html(""),d("#dbmvgseitem").val("1"),d("#dbmvs_seaepi_generator").hide(),d("#dbmvseaeprgrs").hide(),d("#dbmvseaepbtn").show(),d("#gnrtse_"+e).html('<code class="ready">'+s+"</code>"),d("#dbmvseaepbtn").prop("disabled",!0),d("#dbmvseaeptxt").removeClass("flashit"),d("#dbmvseaeprgrs > span").animate({width:"0%"},200,function(){})},300)},l.GenerateAllEpisodesGet=function(){"all"==u&&d(document).ready(function(){d("#dbmovies-generator-epprepa").trigger("click")}),d(document).on("click",".dbmvs_generate_episodes",function(){d(this).hide()})},l.UpdaterEditorPost=function(){1==d(h).length&&d(document).on("click",h,function(){d("#dbmovies-message").remove(),d("#api_table").addClass("hidden_api"),d("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?d.getJSON(i+"/?auth="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var s=d("#post_type").val(),t=d("#ids").val(),a=d("#temporada").val(),o=d("#episodio").val();switch(s){case"movies":l.UpdateEditorMovies(t);break;case"tvshows":l.UpdateEditorTVShows(t);break;case"seasons":l.UpdateEditorSeasons(t,a);break;case"episodes":l.UpdateEditorEpisodes(t,a,o)}}else e.error?l.ErrorNoticeEditor(e.error):l.ErrorNoticeEditor(b)}).fail(function(){l.ErrorNoticeEditor(dbmovies.dbmverr)}):l.ErrorNoticeEditor(dbmovies.misskey)})},l.SetPostContent=function(e){var s,t;e&&"undefined"!=typeof tinymce&&(s=d("textarea#content").val(),(t=tinymce.get("content"))&&t instanceof tinymce.Editor?'<p><br data-mce-bogus="1"></p>'==t.startContent&&(t.setContent(e),t.save({no_events:!0})):s||d("textarea#content").val(e))},l.SetPostImages=function(e){var t;!d("#imagenes").val()&&e&&(t="",d.each(e,function(e,s){return!(9<e)&&void(t+=9==e?s.file_path:s.file_path+"\n")}),d("#imagenes").val(t))},l.TitleReplace=function(e,s,t,a,o){return e.replace("{name}",s).replace("{season}",a).replace("{episode}",o).replace("{year}",t)},l.ImagePreUpload=function(e){1==dbmovies.pupload&&e&&0==d("#postimagediv p img").length&&d("#postimagediv p").html('<ul><li><img src="https://image.tmdb.org/t/p/w500'+e+'"/> </li></ul>')},l.UpdateEditorMovies=function(e){var s=r+"/movie/"+e;apilan="?language="+p,imglan="&include_image_language="+p,aditin=",null&append_to_response=images&api_key="+c,d.getJSON(s.concat(apilan,imglan,aditin),function(e){l.SetPostContent(e.overview),l.SetPostImages(e.images.backdrops),d("#dt_poster").val(e.poster_path),d("#dt_backdrop").val(e.backdrop_path),d("#idtmdb").val(e.id),d("#original_title").val(e.original_title),d("#tagline").val(e.tagline),d("#release_date").val(e.release_date),d("#vote_average").val(e.vote_average),d("#vote_count").val(e.vote_count),d("#runtime").val(e.runtime)}),d.getJSON(i+"/?key="+n+"&imdb="+e,function(e){d("#imdbRating").val(e.rating),d("#imdbVotes").val(e.votes),d("#Rated").val(e.rated),d("#Country").val(e.country)}),l.ErrorFixedEditor()},l.UpdateEditorTVShows=function(e){var s=r+"/tv/"+e;apilan="?language="+p,imglan="&include_image_language="+p,aditin=",null&append_to_response=images&api_key="+c,d.getJSON(s.concat(apilan,imglan,aditin),function(e){l.SetPostContent(e.overview),l.SetPostImages(e.images.backdrops),d("#dt_poster").val(e.poster_path),d("#dt_backdrop").val(e.backdrop_path),d("#original_name").val(e.original_name),d("#first_air_date").val(e.first_air_date),d("#last_air_date").val(e.last_air_date),d("#number_of_seasons").val(e.number_of_seasons),d("#number_of_episodes").val(e.number_of_episodes),d("#imdbRating").val(e.vote_average),d("#imdbVotes").val(e.vote_count),d("#episode_run_time").val(e.episode_run_time[0])}),l.ErrorFixedEditor()},l.UpdateEditorSeasons=function(e,t){var s=r+"/tv/"+e;apilan="?language="+p,aditin="&api_key="+c,d.getJSON(s.concat(apilan,aditin),function(e){d("#serie").val(e.name),d("#title").val()||(d("label#title-prompt-text").addClass("screen-reader-text"),d("#title").val(l.TitleReplace(dbmovies.titseas,e.name,null,t,null))),d.each(e.seasons,function(e,s){t==s.season_number&&(l.SetPostContent(s.overview),l.ImagePreUpload(s.poster_path),d("#dt_poster").val(s.poster_path),d("#air_date").val(s.air_date))})}),l.ErrorFixedEditor()},l.UpdateEditorEpisodes=function(e,t,a){var s=r+"/tv/"+e;apiuep=r+"/tv/"+e+"/season/"+t+"/episode/"+a,apilan="?language="+p,aditin="&api_key="+c,imglan="&include_image_language="+p,rditin=",null&append_to_response=images&api_key="+c,d.getJSON(s.concat(apilan,aditin),function(e){var s=e.name;title=d("#title").val(),d("#serie").val(s),title||(d("label#title-prompt-text").addClass("screen-reader-text"),d("#title").val(l.TitleReplace(dbmovies.titepis,s,null,t,a)))}),d.getJSON(apiuep.concat(apilan,imglan,rditin),function(e){var t;l.SetPostContent(e.overview),l.ImagePreUpload(e.still_path),d("#episode_name").val(e.name),d("#dt_backdrop").val(e.still_path),d("#air_date").val(e.air_date),!d("#imagenes").val()&&e.images.stills&&(t="",d.each(e.images.stills,function(e,s){return!(9<e)&&void(t+=9==e?s.file_path:s.file_path+"\n")}),d("#imagenes").val(t))}),l.ErrorFixedEditor()},l.GenerateEditor=function(){1==d(g).length&&d(document).on("click",g,function(){d("#dbmovies-message").remove(),d("#api_table").addClass("hidden_api"),d("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?d.getJSON(i+"/?auth="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var s=d("#post_type").val(),t=d("#post_ID").val(),a=d("#ids").val(),o=d("#temporada").val(),i=d("#episodio").val();switch(s){case"movies":case"tvshows":l.AddMainTitle(t,a,s);break;case"seasons":l.AddSeason(t,a,o,s);break;case"episodes":l.AddEpisode(t,a,o,i,s)}}else e.error?l.ErrorNoticeEditor(e.error):l.ErrorNoticeEditor(b)}).fail(function(){l.ErrorNoticeEditor(dbmovies.dbmverr)}):l.ErrorNoticeEditor(dbmovies.misskey)})},l.AddMainTitle=function(e,s,t){s?d.ajax({url:m,type:"POST",dataType:"json",data:{idpost:e,tmdbid:s,typept:t,action:"dbmovies_genereditor"},success:function(e){1==e.response&&window.location.replace(e.editlink),0==e.response&&l.ErrorNoticeEditor(e.message)}}):l.ErrorFixedEditor()},l.AddSeason=function(s,t,a,o){t&&a?d.getJSON(r+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){d.ajax({url:m,type:"POST",dataType:"json",data:{idpost:s,tmdbid:t,typept:o,season:a,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?l.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&l.ErrorNoticeEditor(e.message)}})}).fail(function(){l.ErrorNoticeEditor(dbmovies.tmdberr)}):l.ErrorFixedEditor()},l.AddEpisode=function(s,t,a,o,i){t&&a&&o?d.getJSON(r+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){d.ajax({url:m,type:"POST",dataType:"json",data:{idpost:s,tmdbid:t,typept:i,season:a,episde:o,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?l.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&l.ErrorNoticeEditor(e.message)}})}).fail(function(){l.ErrorNoticeEditor(dbmovies.tmdberr)}):l.ErrorFixedEditor()},l.ErrorNoticeEditor=function(e){d("#postbox-container-2").prepend('<div id="dbmovies-message" class="notice notice-warning"><p>'+e+"</p></div>"),d("#loading_api").html(""),d("#api_table").removeClass("hidden_api")},l.ErrorFixedEditor=function(){d("#loading_api").html(""),d("#api_table").removeClass("hidden_api")},l.NavSettings=function(){var e=l.getCookie("_dbmvs_tabname"),s="#dbmvs-nav-settings > li.nav-tab";1==d("#dbmvs-nav-settings").length&&setTimeout(function(){d("#settab-"+e).trigger("click")},1),d(document).on("click",s,function(){var e=d(this).data("tab");return 0!=e&&(d(s).removeClass("nav-tab-active"),d(".tab-content").removeClass("on"),d(this).addClass("nav-tab-active"),d("#dbmv-setting-"+e).addClass("on"),l.setCookie("_dbmvs_tabname",e,30)),!1})},l.SaveSettings=function(){var s="#dbmvsbtn-savesettings",t="#dbmvsssrespnc";d(document).on("submit","#dbmovies-settings",function(){return d(s).prop("disabled",!0),d(".tab-content").addClass("onprogress"),d.ajax({url:m,type:"POST",dataType:"json",data:d(this).serialize(),success:function(e){n&&1!=e.reload?(d(".tab-content").removeClass("onprogress"),d(t).addClass("fadein"),d(t).html(e.message),setTimeout(function(){d(s).prop("disabled",!1),d(t).html(""),d(t).removeClass("fadein")},1e3)):location.reload()}}),!1})},l.GoTop=function(){var e="#dbmovies-back-top";1==d(e).length&&(d(e).hide(),d(function(){d(window).scroll(function(){200<d(this).scrollTop()?d(e).fadeIn():d(e).fadeOut()}),d(e).click(function(){return d("body,html").animate({scrollTop:0},500),!1})}))},l.LogCollapse=function(){d(document).on("click",".dbmovies-log-collapse",function(){return d(this).toggleClass("expand"),d("#dbmovies-logs-box").toggleClass("expand"),!1})},l.Auth=function(){d.each(["#dbmvs-forms-response","#dbmovies-importer",".dbmovies-tvshow-content-generator"],function(e,s){d(s).length&&(n?(l.ApiRemoteData(!0),setInterval(function(){l.ApiRemoteData(!1)},6e4)):(1==d("#dbmovies-dbmvs-application").length&&window.location.replace("admin.php?page=dbmvs-settings"),l.AuthModules()))}),d(document).on("click",".dbdata",function(){return!1}),d(document).on("click",".dbdata.consultor",function(){return d(".dbdata").removeClass("consultor"),l.ApiRemoteData(!1),setTimeout(function(){d(".dbdata").addClass("consultor")},1e4),!1})},l.ApiRemoteData=function(s){t?d.getJSON(i+"/?auth="+n,function(e){"1"==e.status?(d(".dbmvs-credits").show(),d("#dbmvs-credits").html(l.NumberFormat(e.credits)),d("#dbmvs-credits-used").html(l.NumberFormat(e.used_credits)),d("#dbmvs-requests").html(l.NumberFormat(e.requests)),1<=e.credits||1==e.unlimited?1==s&&(d("#dbmvs-logo-status").addClass("ready"),d("#dbmvs-log-indicator").after('<li class="fadein"><span class="type">dbmvs</span>'+dbmovies.welcom+"</li>")):(l.AuthModules(),d("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+b+"</li>"))):(l.AuthModules(),d("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+e.error+"</li>"),d("#dbmvs-logo-status").addClass("flashit error")),d(".dbmovies-logs").show()}):(d("#dbmvs-forms-response").remove(),d(".dbmovies-logs").show(),d("#dbmvs-log-indicator").after('<li class="bounce bigmessage">'+dbmovies.nointrn+"</li>"))},l.AuthModules=function(){d("#dbmvs-forms-response").remove(),d("#dbmovies-importer").remove(),d(".dbmovies-tvshow-content-generator").remove()},l.IMDbUpdater=function(){d(document).on("click","#dbmvs-imdb",function(){var e=parseInt(d(y).val());return d(this).hide(),d("#dbmovies-li-imdb > span.spinner").show(),d("#dbmovies-li-imdb > span.percentage").show(),d.ajax({url:m,type:"POST",dataType:"json",data:{page:e,action:"dbmovies_app_upimdb"},success:function(l){var m=[];1==l.response?(d(y).val(++e),d(".progressing").animate({width:l.prgss+"%"},50,function(){}),d("#dbmovies-li-imdb > span.percentage").html(l.prgss+"%"),d.each(l.imdb,function(e,s){var t=s.imdb,a=s.rating+" - ",o=(s.votes,s.title),i=s.plink,n='<span class="type">'+s.imdb+"</span>",r='<a href="'+i+'">'+o+"</a>",d='<span class="microtime">'+l.mtime+"</span>";t?m.push('<li class="jump">'+n+a+r+d+"</li>"):m.push('<li class="jump"><span class="error">'+s.message+"</span>"+d+"</li>")}),d("#dbmvs-log-indicator").after(m.join("")),setTimeout(function(){d("#dbmvs-imdb").trigger("click")},50)):(d("#dbmovies-li-imdb > span.percentage").hide(),d("#dbmovies-li-imdb > span.spinner").hide(),d("#dbmvs-imdb").show(),d(".progressing").animate({width:"0%"},4e3,function(){}),setTimeout(function(){location.reload()},4500))}}),!1})},l.CodeStarTab=function(){e&&(d(".cs-section").hide(),d(".cs-nav ul a").removeClass("cs-section-active"),d("#tab-"+e).addClass("cs-section-active"),d("#cs-tab-"+e).show())},l.ReubicateForm=function(){var e,s="#dbmvoies-importer-html";1==d(s).length&&(e=d(s).html(),d(".wp-header-end").after(e),d(s).remove())},l.Application=function(){var e=l.getCookie("_dbmvs_tabapp"),s=".dbmvs-tab-content";1==d("#dbmovies-dbmvs-application").length&&setTimeout(function(){d("#dbmvstabapp-"+e).trigger("click")},1),d(document).on("click",s,function(){var e;return d(this).hasClass("button-primary")||(e=d(this).data("type"),d(".genres").removeClass("on"),d("#genres-box-"+e).addClass("on"),d("#dbmvs-filter-type").val(e),d("#dbmvs-search-type").val(e),d(s).removeClass("button-primary"),d(this).addClass("button-primary"),l.FixingApiResults(),l.setCookie("_dbmvs_tabapp",e,30)),!1})},l.Cimport=function(){d.each(["#dbmvs-year","#dbmvs-movies-genres","#dbmvs-tvshows-genres","#dbmvs-filter-type","#dbmvs-popularity","#dbmvs-search-term"],function(e,s){d(document).on("change",s,function(){l.FixingApiResults()})}),d(document).on("click","#bulk-importer",function(){return d("#bulk-importer-click").hide(),d(".cimport").each(function(){var e=d(this),s=e.data("type"),t=e.data("tmdb");return e.hide(),e.removeClass("cimport"),d("#tmdb-"+t).removeClass("fadein"),d("#tmdb-"+t).removeClass("non-existent"),d("#tmdb-"+t).addClass("onload jump"),l.TMDbAppImport(s,t,!0,a),!1}),!1}),d(document).on("click",".cimport",function(){var e=d(this),s=e.data("type"),t=e.data("tmdb");return e.hide(),e.removeClass("cimport"),d("#tmdb-"+t).removeClass("fadein"),d("#tmdb-"+t).removeClass("non-existent"),d("#tmdb-"+t).addClass("onload jump"),l.TMDbAppImport(s,t,!1,!1),!1})},l.FixingApiResults=function(){d("#dbmovies-loadmore").removeClass("search"),d("#dbmovies-loadmore").removeClass("filter"),d("#dbmvs-results-number").html(0),d("#bulk-importer-click").hide(),d("#dbmovies-loadmore").hide(),d("#dbmvs-page").val(1),d("#dbmvs-search-page").val(1),d(".item").remove()},l.TMDbAppImport=function(e,s,t,a){t&&!a&&setTimeout(function(){d("#bulk-importer").trigger("click")},o),d.ajax({url:m,type:"POST",dataType:"json",data:{ptype:e,ptmdb:s,action:"dbmovies_insert_tmdb"},success:function(e){l.ComposeItemLog(e),1==e.response?(d("#tmdb-"+s).removeClass("onload"),d("#tmdb-"+s).removeClass("fadein"),d("#tmdb-"+s).addClass("existent bounce"),a&&d("#bulk-importer").trigger("click")):(d("#tmdb-"+s).removeClass("onload"),d("#tmdb-"+s).addClass("error"),d("#cimprt-"+s).addClass("cimport"),d("#cimprt-"+s).show())}})},l.Search=function(){d(document).on("submit","#dbmovies-form-search",function(){return d("#dbmvs-btn-search").prop("disabled",!0),d("#dbmovies-loadmore").addClass("search disabled"),d("#dbmovies-loadmore").hide(),d("#dbmovies-loadmore-spinner").show(),d.ajax({url:m,type:"POST",dataType:"json",data:d(this).serialize(),success:function(e){var s=parseInt(d("#dbmvs-search-page").val());d("#current-page").val(e.page),d("#current-year").val(e.year),d("#dtotal-items").val(e.items),d("#dbmvs-results-number").html(l.NumberFormat(e.total)),d("#dbmovies-loadmore-spinner").hide(),d("#dbmovies-loadmore").removeClass("disabled"),l.ComposeFilterLog(e),1==e.response&&(s<e.pages?d("#dbmovies-loadmore").show():d("#dbmovies-loadmore").removeClass("search"),d("#dbmvs-btn-search").prop("disabled",!1),l.ComposeResults(e.results)),0==e.response&&l.FixingApiResults()}}),!1})},l.Filter=function(){d("#current-page").val(),d("#current-year").val();d(document).on("submit","#dbmovies-form-filter",function(){return d("#bulk-importer-click").hide(),d("#dbmovies-loadmore").hide(),d("#dbmovies-loadmore").addClass("filter disabled"),d("#dbmvs-btn-filter").prop("disabled",!0),d("#dbmovies-loadmore-spinner").show(),d.ajax({url:m,type:"POST",dataType:"json",data:d(this).serialize(),success:function(e){var s=parseInt(d("#dbmvs-page").val());d("#current-page").val(e.page),d("#current-year").val(e.year),d("#dtotal-items").val(e.items),d("#dbmvs-results-number").html(l.NumberFormat(e.total)),d("#dbmovies-loadmore").removeClass("disabled"),l.ComposeFilterLog(e),d("#dbmovies-loadmore-spinner").hide(),1==e.response&&(s<e.pages&&d("#dbmovies-loadmore").show(),d("#bulk-importer-click").show(),d("#dbmvs-btn-filter").prop("disabled",!1),l.ComposeResults(e.results)),0==e.response&&(alert(e.message),d("#dbmvs-btn-filter").prop("disabled",!1),l.FixingApiResults())}}),!1})},l.ComposeResults=function(e){var i=[];d.each(e,function(e,s){var t,a,o;d("#tmdb-"+s.id).length||(t="","non-existent"==s.db&&(t='<div id="cimprt-'+s.id+'" class="cimport" data-tmdb="'+s.id+'" data-type="'+s.tp+'"></div>'),a='<div class="image"><img src="'+s.im+'">'+t+"</div>",o='<div class="data"><h3>'+s.ti+"</h3><span>"+s.dt+"</span></div>",i.push('<div class="item fadein"><article class="'+s.db+'" id="tmdb-'+s.id+'">'+a+o+"</article></div>"))}),d("#response-dbmovies").before(i.join(""))},l.ComposeItemLog=function(e){var s,t,a,o="";o=1==e.response?(s='<span class="type green">'+e.status+"</span>",t='<span class="type">'+e.type+"</span>",a='<a href="'+e.permalink+'" target="_blank">'+e.title+"</a>",s+t+('<span class="edit"><a href="'+e.editlink+'" target="_blank">'+dbmovies.editxt+"</a></span>")+a+('<span class="microtime">'+e.mtime+"</span>")):e.message,d("#dbmvs-log-indicator").after('<li class="bounce">'+o+"</li>")},l.ComposeFilterLog=function(e){var s,t,a="";a=1==e.response?(s='<span class="type green">'+e.type+"</span>",t='<span class="microtime">'+e.mtime+"</span>",s+dbmovies.complt+t):e.message,d("#dbmvs-log-indicator").after('<li class="fadein">'+a+"</li>")},l.LoadMore=function(){d.each([".dbmvsloadmore.search",".dbmvsloadmore.filter"],function(e,t){d(document).on("click",t,function(){var e;return".dbmvsloadmore.filter"==t&&(e=parseInt(d("#dbmvs-page").val())),".dbmvsloadmore.search"==t&&(e=parseInt(d("#dbmvs-page").val())),e&&!d(this).hasClass("disabled")&&(".dbmvsloadmore.filter"==t&&(d("#dbmvs-page").val(++e),d("#dbmvs-btn-filter").trigger("click")),".dbmvsloadmore.search"==t&&(d("#dbmvs-search-page").val(++e),d("#dbmvs-btn-search").trigger("click"))),!1}),s&&d(window).scroll(function(){var e=d(this),s=d(".wrapp");d("#dtotal-items").val()<parseInt(v)&&e.scrollTop()>=s.height()-e.height()+240&&(d("#dbmovies-loadmore").hasClass("disabled")||setTimeout(function(){d(t).trigger("click")},500))})})},l.Importer=function(){1==d(_).length&&d(document).on("submit",_,function(){var s="#dbmovies-btn-importer",t="#dbmovies-inp-tmdb";return d(s).prop("disabled",!0),d(t).addClass("disabled"),d(s).val(dbmovies.loading),d(".wp-list-table").addClass("onprogress"),d(_).addClass("onprogress"),d("#dbmovies-loader").addClass("is-active"),d.ajax({url:m,type:"POST",dataType:"json",data:d(this).serialize(),success:function(e){1==e.response?window.location.replace(e.editlink):(alert(e.message),d(s).prop("disabled",!1),d(t).removeClass("disabled"),d(s).val(dbmovies.import),d(_).removeClass("onprogress"),d(".wp-list-table").removeClass("onprogress"),d("#dbmovies-loader").removeClass("is-active"))}}),!1})},l.GeneratorSeasons=function(){var i=d("#ids").val();d(document).on("click","#dbmovies-generator-seprepa",function(){var e=d("#tmdbseasos").val(),s=d("#tmdbsename").val();return d(this).prop("disabled",!0),e||s||d.getJSON(r+"/tv/"+i+"?language="+p+"&api_key="+c,function(e){var s=e.name?e.name:e.original_name;d("#tmdbsename").val(s),d.each(e,function(e,s){"number_of_seasons"==e&&(d("#tmdbseasos").val(s),d("#number_of_seasons").val(s),d("#dbmovies-json-response").html("0/"+s)),"number_of_episodes"==e&&d("#number_of_episodes").val(s)}),d("#dbmovies-generator-seprepa").removeClass("button-primary"),d(C).removeClass("button-secundary"),d(C).addClass("button-primary"),d(C).prop("disabled",!1)}),!1}),d(document).on("click",C,function(){var e=parseInt(d("#tmdbseason").val()),s=parseInt(d("#tmdbseasos").val()),t=d("#tmdbsename").val(),a=d("#postparent").val(),o=(e-1)/s*100;return d(this).prop("disabled",!0),d(this).hide(300),d("#dbmovies-loader").addClass("is-active"),l.Progress(o),e<=s?(d("#tmdbseason").val(e+1),d(f).html(e+"/"+s),d.ajax({url:m,type:"POST",dataType:"json",data:{tmdb:i,tmse:e,name:t,post:a,action:"dbmovies_generate_se"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),d(C).prop("disabled",!1),setTimeout(function(){d(C).trigger("click")},75)):location.reload()}})):location.reload(),!1})},l.GeneratorEpisodes=function(){var i=d("#ids").val(),n=d("#temporada").val();d(document).on("click","#dbmovies-generator-epprepa",function(){d("#tmdbepisos").val(),d("#tmdbsename").val();return d(this).prop("disabled",!0),d.getJSON(r+"/tv/"+i+"?language="+p+"&api_key="+c,function(a){d.each(a.seasons,function(e,s){var t;n==s.season_number&&(t=a.name?a.name:a.original_name,d("#tmdbsename").val(t),d("#tmdbepisos").val(s.episode_count),d("#dbmovies-json-response").html("0/"+s.episode_count))}),d("#dbmovies-generator-epprepa").removeClass("button-primary"),d(k).removeClass("button-secundary"),d(k).addClass("button-primary"),d(k).prop("disabled",!1),"all"==u&&setTimeout(function(){d(k).trigger("click")},1500)}),!1}),d(document).on("click",k,function(){var e=parseInt(d("#tmdbepisod").val()),s=parseInt(d("#tmdbepisos").val()),t=d("#tmdbsename").val(),a=d("#postparent").val(),o=(e-1)/s*100;return d(this).prop("disabled",!0),d(this).hide(300),d("#dbmovies-loader").addClass("is-active"),l.Progress(o),e<=s?(d("#tmdbepisod").val(e+1),d(f).html(e+"/"+s),d.ajax({url:m,type:"POST",dataType:"json",data:{tmdb:i,tmse:n,tmep:e,name:t,post:a,action:"dbmovies_generate_ep"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),d(k).prop("disabled",!1),setTimeout(function(){d(k).trigger("click")},75)):"all"==u?window.close():location.reload()}})):"all"==u?window.close():location.reload(),!1})},l.Progress=function(e){d("#dbmovies-progress").animate({width:e+"%"},150,function(){})},l.NumberFormat=function(e){x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var s=/(\d+)(\d{3})/;s.test(x1);)x1=x1.replace(s,"$1,$2");return x1+x2},l.setCookie=function(e,s,t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3);var o="expires="+a.toUTCString();document.cookie=e+"="+s+";"+o+";path=/"},l.getCookie=function(e){for(var s=e+"=",t=decodeURIComponent(document.cookie).split(";"),a=0;a<t.length;a++){for(var o=t[a];0==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(s))return o.substring(s.length,o.length)}return!1},l.delCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}(jQuery);
