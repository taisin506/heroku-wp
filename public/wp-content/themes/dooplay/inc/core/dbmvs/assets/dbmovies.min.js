!function(l){var r={},d=dbmovies.ajaxurl,i=dbmovies.dapiurl,m=dbmovies.tapiurl,n=dbmovies.dapikey,c=dbmovies.tapikey,p=dbmovies.apilang,a=dbmovies.safemod,o=dbmovies.extimer,s=dbmovies.inscrll,v=dbmovies.rscroll,e=dbmovies.csectin,b=dbmovies.nocrdt,u=dbmovies.gerepis,t=navigator.onLine,g="#dbmovies-generartor",h="#dbmovies-updaterpost",f="#dbmovies-json-response",_="#dbmovies-importer",C="#dbmovies-generator-seasons",k="#dbmovies-generator-episodes",y="#dbmovies-imdb-updater-page";l(function(){r.GenerateSeEp(),r.PostGenerateSeEp(),r.GenerateAllEpisodesGet(),r.UpdaterEditorPost(),r.GenerateEditor(),r.NavSettings(),r.SaveSettings(),r.GoTop(),r.LogCollapse(),r.Auth(),r.IMDbUpdater(),r.CodeStarTab(),r.Application(),r.Search(),r.Filter(),r.LoadMore(),r.Importer(),r.Cimport(),r.GeneratorSeasons(),r.GeneratorEpisodes(),r.ReubicateForm(),r.LogCleaner(),r.InternetCon(),r.Dashboard(),r.MetaUpdater()}),r.MetaUpdater=function(){var e,s,t,a="dbmovies_metaupdater",o="#dbmvs-metaupdater";StatusMU="#dbmvs-metaupdater-status",Proccess="#meta-updater-process",MControl="#meta-updater-controls",MtUPause="#meta-updater-pause",RunMTUpT="#meta-updater-run",1!=o.length&&(e=r.getCookie("_dbmvs_metaupdater_status"),s=r.getCookie("_dbmvs_metaupdater_progress"),t=r.getCookie("_dbmvs_metaupdater_running"),"paused"==e&&(l(StatusMU).val(s),l(Proccess).show(),l(Proccess+"> span.spinner").hide(),l(Proccess+"> .proccess-bar > .into").addClass("flashit"),l(Proccess+"> span.percentage").text(r.NumberFormat(s)+" %"),l(RunMTUpT).hide(),l(MtUPause).hide(),l(MControl).show(),l(Proccess+"> .proccess-bar > .into").animate({width:s+"%"},150,function(){})),1==t&&"paused"!=e&&(l(Proccess+"> span.percentage").text(r.NumberFormat(s)+" %"),l(Proccess+"> .proccess-bar > .into").animate({width:s+"%"},1e3,function(){}),setTimeout(function(){l(o).trigger("click")},1e3)),l(document).on("click","#dbmvs-finish-metaupdater",function(){var e=l(this).data("control");return confirm("You are about to interrupt the process")&&(l(MtUPause).hide(),l(Proccess).hide(),l(MControl).hide(),l(RunMTUpT).show(),l(Proccess+"> span.spinner").show(),l(Proccess+"> .proccess-bar > .into").removeClass("flashit"),l(StatusMU).val("progress"),l.ajax({url:d,type:"POST",dataType:"json",data:{action:a,process:e},success:function(e){r.delCookie("_dbmvs_metaupdater_running"),r.delCookie("_dbmvs_metaupdater_status"),r.delCookie("_dbmvs_metaupdater_progress"),l("#dbmvs-log-indicator").after('<li class="shake"><span class="type error">dbmvs</span>'+e.message+"</li>")}})),!1}),l(document).on("click",o,function(){var e=l(StatusMU).val(),s=l(this).data("control");return"progress"==e&&(l(MtUPause).show(),l(Proccess).show(),l(RunMTUpT).hide(),l.ajax({url:d,type:"POST",dataType:"json",data:{action:a,process:s},success:function(e){1==e.success?(l(o).trigger("click"),l(Proccess+"> .proccess-bar > .into").animate({width:e.progress+"%"},150,function(){}),l(Proccess+"> span.percentage").text(r.NumberFormat(e.progress)+" %"),r.setCookie("_dbmvs_metaupdater_progress",e.progress,30),r.setCookie("_dbmvs_metaupdater_running",1,30),r.ComposeItemLog(e.content)):(r.delCookie("_dbmvs_metaupdater_running"),r.delCookie("_dbmvs_metaupdater_status"),r.delCookie("_dbmvs_metaupdater_progress"),l(Proccess+"> .proccess-bar > .into").animate({width:"0%"},800,function(){}),setTimeout(function(){l(MtUPause).hide(),l(Proccess).hide(),l(MControl).hide(),l(RunMTUpT).show(),l(Proccess+"> span.spinner").show(),l(Proccess+"> .proccess-bar > .into").removeClass("flashit"),l(StatusMU).val("progress")},1e3))}})),!1}),l(document).on("click",".metaupdater-control",function(){switch(l(this).data("control")){case"continue":l(MControl).hide(),l(MtUPause).show(),l(Proccess+"> span.spinner").show(),l(Proccess+"> .proccess-bar > .into").removeClass("flashit"),l(StatusMU).val("progress"),r.setCookie("_dbmvs_metaupdater_status","progress",30),setTimeout(function(){l(o).trigger("click")},500);break;case"finish":break;case"pause":l(Proccess+"> span.spinner").hide(),l(Proccess+"> .proccess-bar > .into").addClass("flashit"),l(MtUPause).hide(),l(MControl).show(),l(StatusMU).val("paused"),r.setCookie("_dbmvs_metaupdater_status","paused",30)}return!1}))},r.TimeSince=function(e){var s=Math.floor((Date.now()-e)/1e3),t=dbmovies.timest.seconds;s<0&&(s=-s);e=s;return 31536e3<=s?t=1!=(e=Math.floor(s/31536e3))?dbmovies.timest.years:dbmovies.timest.year:2592e3<=s?t=1!=(e=Math.floor(s/2592e3))?dbmovies.timest.months:dbmovies.timest.month:604800<=s?t=1!=(e=Math.floor(s/604800))?dbmovies.timest.weeks:dbmovies.timest.week:86400<=s?t=1!=(e=Math.floor(s/86400))?dbmovies.timest.days:dbmovies.timest.day:3600<=s?t=1!=(e=Math.floor(s/3600))?dbmovies.timest.hours:dbmovies.timest.hour:60<=s&&(t=1!=(e=Math.floor(s/60))?dbmovies.timest.minutes:dbmovies.timest.minute),e+" "+t},r.Dashboard=function(){var a=l("#dbmovies-inboxes-nonce").val();1==l("#dooplay_dashboard_widget").length&&(1==dbmovies.formrpt?(l("#doodashcont-reported-click").addClass("active"),l("#doodashcont-reported").addClass("on")):1==dbmovies.formcot&&0==dbmovies.formrpt&&(l("#doodashcont-reported-click").remove(),l("#doodashcont-reported").remove(),l("#doodashcont-inbox-click").addClass("active"),l("#doodashcont-inbox").addClass("on")),0==dbmovies.formcot&&(l("#doodashcont-inbox-click").remove(),l("#doodashcont-inbox").remove())),l(document).on("click",".dooplay-dashaboard-navigation",function(){var e=l(this).attr("data-id");e&&(l(".dooplay-dashaboard-navigation").removeClass("active"),l(this).addClass("active"),l(".dashcont").removeClass("on"),l("#doodashcont-"+e).addClass("on"))}),1==l("#response-inboxes-report").length&&1==dbmovies.formrpt&&r.GetDataInboxes("report",1,a),1==l("#response-inboxes-contact").length&&1==dbmovies.formcot&&r.GetDataInboxes("contact",1,a),l(document).on("click",".inboxes-loadmore",function(){var e=l(this).data("type"),s=l("#inboxes-input-"+e).val();return l("#response-inboxes-"+e).addClass("loader"),l(this).prop("disabled",!0),console.log(this),r.GetDataInboxes(e,s,a,this),!1}),l(document).on("click",".close-inboxes",function(){var e=l(this).data("type"),e="#post-"+l(this).data("id")+"-"+e;return 1==l(e+" > div.message").length&&(l(e).removeClass("reading"),l(e).addClass("read"),l(e+" > .message").remove()),!1}),l(document).on("click",".inboxes-readme-message.unread",function(){var e="#response-count-"+l(this).data("type")+"-unread",s=parseInt(l(e).text());l(e).text(s-1),l(e+"-span").text("("+(s-1)+")")}),l(document).on("click",".inboxes-delete-post",function(){var s=l(this).data("type"),e=l(this).data("id"),t="#post-"+e+"-"+s;return l(t).hide(),l.ajax({url:d,type:"POST",dataType:"json",data:{action:"dbmovies_inboxes_deleting",post:e,type:s,nonce:a},success:function(e){1==e.success?(l(t).remove(),l("#response-count-"+s+"-unread-span").text("("+e.unread+")"),l("#response-count-"+s+"-unread").text(e.unread),l("#response-count-"+s+"-total").text(e.total),0==e.total&&l("#response-inboxes-"+s+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>")):l(t).show()}}),!1}),l(document).on("click",".inboxes-readme-message",function(){var e=l(this).data("type"),s=l(this).data("id"),t="#post-"+s+"-"+e;return l(this).removeClass("unread"),l(this).addClass("read"),1!=l(t+" > div.message").length?(l("#response-inboxes-"+e+" > .item > .message").remove(),l("#response-inboxes-"+e+" > .item").removeClass("reading"),l(t).removeClass("unread"),l(t).addClass("reading"),l(t+" > h4").after('<div class="message"><div class="onload"></div></div>'),l.ajax({url:d,type:"POST",dataType:"html",data:{action:"dbmovies_inboxes_reading",type:e,post:s,nonce:a},success:function(e){l(t).addClass("read"),l(t+" > .message").addClass("fadein"),l(t+" > .message").html(e)}})):(l(t+" > .message").removeClass("fadein"),l(t+" > .message").addClass("shake"),setTimeout(function(){l(t+" > .message").removeClass("shake")},800)),!1})},r.GetDataInboxes=function(n,s,e,t){l.getJSON(d+"?action=dbmovies_inboxes&type="+n+"&page="+s+"&nonce="+e,function(e){l("#response-count-"+n+"-unread-span").text("("+e.unread+")"),l("#response-count-"+n+"-unread").text(e.unread),l("#response-count-"+n+"-total").text(e.total);var i=[];l("#response-inboxes-"+n+" > .onload").remove(),l("#response-inboxes-"+n).removeClass("loader"),e.posts&&(l.each(e.posts,function(e,s){var t='<div id="post-'+s.ID+"-"+n+'" class="fadein item '+s.post_status+'" data-id="'+s.ID+'">',a='<a href="#" class="inboxes-delete-post" data-id="'+s.ID+'" data-type="'+n+'"><i class="dashicons dashicons-trash"></i></a>',o='<span class="date">'+r.TimeSince(new Date(s.post_date))+"</span>",s='<a href="#" data-id="'+s.ID+'" data-type="'+n+'" class="inboxes-readme-message '+s.post_status+'">'+s.post_title+"</a></h4></div>";i.push(t+'<h4 class="title"><i class="dashicons dashicons-email"></i>'+a+o+s)}),l("#response-inboxes-"+n+" > .hidden").before(i.join("")),l(t).prop("disabled",!1),e.pages>s?(l("#inboxes-paginator-"+n).removeClass("hidden"),l("#inboxes-input-"+n).val(Math.floor(parseInt(s)+1))):l("#inboxes-paginator-"+n).addClass("hidden")),0==e.total&&l("#response-inboxes-"+n+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>"),e.error&&l("#response-inboxes-"+n+" > .hidden").before('<div class="inboxes-notice"><p>'+e.error+"</p></div>")})},r.InternetCon=function(){t||console.log("No hay conexion a Internet")},r.LogCleaner=function(){Cleaner="#dbmovies-cleanlog",l(document).on("click",Cleaner,function(){return l(Cleaner).html(dbmovies.cleangn),setTimeout(function(){l("#dbmovies-logs-box > ul").html('<i id="dbmvs-log-indicator"></i><li class="jump"><span class="type">dbmvs</span>'+dbmovies.cllogs+"</li>"),l(Cleaner).html(dbmovies.cleancl)},200),!1})},r.GenerateSeEp=function(){l(document).on("click","#dbmvseaepbtncl",function(){var e=l("#dbmvgsepare").val();return l("#dbgesbtn_"+e).show(),l("#dbmvs_seaepi_generator").hide(),setTimeout(function(){l("#dbmvseaepbtncl").addClass("hidden"),l("#dbmvseaepico").removeClass("done"),l("#dbmvseaepico").addClass("loading"),l("#dbmvseaeprgrs").removeClass("flashit"),l("#dbmvgseitem").val("1"),l("#dbmvgsetmdb").val(""),l("#dbmvgsetotl").val(""),l("#dbmvgsepare").val(""),l("#dbmvgsetype").val(""),l("#dbmvgsename").val(""),l("#dbmvgseseas").val("")},700),!1}),l(document).on("click",".dbmvsarchiveseep",function(){var s,t,a,o;return n&&(l(this).hide(),l("#dbmvs_seaepi_generator").show(),s=l(this).data("parent"),t=l(this).data("tmdb"),a=l(this).data("season"),o=l(this).data("type"),l.getJSON(i+"/?check="+n,function(e){l("#dbmvgsepare").val(s),l("#dbmvgsetmdb").val(t),l("#dbmvgsetype").val(o),l("#dbmvgseseas").val(a),(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited)&&l.getJSON(m+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){var s=e.name||e.original_name;switch(l("#dbmvgsename").val(s),o){case"seasons":l("#dbmvgsetotl").val(e.number_of_seasons);break;case"episodes":l.each(e.seasons,function(e,s){a==s.season_number&&l("#dbmvgsetotl").val(s.episode_count)})}l("#dbmvseaeptxt").html(""),l("#dbmvseaeprgrs").show(),l("#dbmvseaeprgrs").addClass("flashit"),l("#dbmvseaepbtncl").removeClass("hidden"),l("#dbmvseaepico").removeClass("loading"),l("#dbmvseaepico").addClass("done"),l("#dbmvseaepbtn").prop("disabled",!1)})})),!1})},r.PostGenerateSeEp=function(){l(document).on("submit","#dbmvseaepigenerator",function(){var s=l("#dbmvgsepare").val(),t=l("#dbmvgsetmdb").val(),a=parseInt(l("#dbmvgseitem").val()),o=parseInt(l("#dbmvgsetotl").val()),i=a/o*100;return l("#dbmvseaepbtn").hide(),l("#dbmvseaepbtncl").addClass("hidden"),l("#dbmvseaeprgrs").removeClass("flashit"),l("#dbmvseaepico").removeClass("done"),l("#dbmvseaepico").addClass("loading"),l("#dbmvseaeptxt").addClass("flashit"),l("#dbmvseaeptxt").html(dbmovies.loading),l("#gnrtse_"+s).html(dbmovies.prsseng),l.ajax({url:d,type:"POST",dataType:"json",data:l(this).serialize(),success:function(e){l("#dbmvgseitem").val(a+1),1==e.response?(e=a+" / "+o+" >> "+e.title+" >> "+e.mtime,console.log(e),l("#dbmvgseconsolelog").html(e),l("#dbmvseaeprgrs > span").animate({width:i+"%"},150,function(){}),a<o?setTimeout(function(){l("#dbmvseaepbtn").trigger("click")},100):r.PostGenerateSeEpFix(s,t)):r.PostGenerateSeEpFix(s,t)}}),!1})},r.PostGenerateSeEpFix=function(e,s){setTimeout(function(){l("#dbmvgseconsolelog").html(""),l("#dbmvgseitem").val("1"),l("#dbmvs_seaepi_generator").hide(),l("#dbmvseaeprgrs").hide(),l("#dbmvseaepbtn").show(),l("#gnrtse_"+e).html('<code class="ready">'+s+"</code>"),l("#dbmvseaepbtn").prop("disabled",!0),l("#dbmvseaeptxt").removeClass("flashit"),l("#dbmvseaeprgrs > span").animate({width:"0%"},200,function(){})},300)},r.GenerateAllEpisodesGet=function(){"all"==u&&l(document).ready(function(){l("#dbmovies-generator-epprepa").trigger("click")}),l(document).on("click",".dbmvs_generate_episodes",function(){l(this).hide()})},r.UpdaterEditorPost=function(){1==l(h).length&&l(document).on("click",h,function(){l("#dbmovies-message").remove(),l("#api_table").addClass("hidden_api"),l("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?l.getJSON(i+"/?check="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var s=l("#post_type").val(),t=l("#ids").val(),a=l("#temporada").val(),o=l("#episodio").val();switch(s){case"movies":r.UpdateEditorMovies(t);break;case"tvshows":r.UpdateEditorTVShows(t);break;case"seasons":r.UpdateEditorSeasons(t,a);break;case"episodes":r.UpdateEditorEpisodes(t,a,o)}}else e.error?r.ErrorNoticeEditor(e.error):r.ErrorNoticeEditor(b)}).fail(function(){r.ErrorNoticeEditor(dbmovies.dbmverr)}):r.ErrorNoticeEditor(dbmovies.misskey)})},r.SetPostContent=function(e){var s,t;e&&"undefined"!=typeof tinymce&&(s=l("textarea#content").val(),(t=tinymce.get("content"))&&t instanceof tinymce.Editor?'<p><br data-mce-bogus="1"></p>'==t.startContent&&(t.setContent(e),t.save({no_events:!0})):s||l("textarea#content").val(e))},r.SetPostImages=function(e){var t;!l("#imagenes").val()&&e&&(t="",l.each(e,function(e,s){return!(9<e)&&void(t+=9==e?s.file_path:s.file_path+"\n")}),l("#imagenes").val(t))},r.TitleReplace=function(e,s,t,a,o){return e.replace("{name}",s).replace("{season}",a).replace("{episode}",o).replace("{year}",t)},r.ImagePreUpload=function(e){1==dbmovies.pupload&&e&&0==l("#postimagediv p img").length&&l("#postimagediv p").html('<ul><li><img src="https://image.tmdb.org/t/p/w500'+e+'"/> </li></ul>')},r.UpdateEditorMovies=function(e){var s=m+"/movie/"+e;apilan="?language="+p,imglan="&include_image_language="+p,aditin=",null&append_to_response=images&api_key="+c,l.getJSON(s.concat(apilan,imglan,aditin),function(e){r.SetPostContent(e.overview),r.SetPostImages(e.images.backdrops),l("#dt_poster").val(e.poster_path),l("#dt_backdrop").val(e.backdrop_path),l("#idtmdb").val(e.id),l("#original_title").val(e.original_title),l("#tagline").val(e.tagline),l("#release_date").val(e.release_date),l("#vote_average").val(e.vote_average),l("#vote_count").val(e.vote_count),l("#runtime").val(e.runtime)}),l.getJSON(i+"/?key="+n+"&imdb="+e,function(e){l("#imdbRating").val(e.rating),l("#imdbVotes").val(e.votes),l("#Rated").val(e.rated),l("#Country").val(e.country)}),r.ErrorFixedEditor()},r.UpdateEditorTVShows=function(e){e=m+"/tv/"+e;apilan="?language="+p,imglan="&include_image_language="+p,aditin=",null&append_to_response=images&api_key="+c,l.getJSON(e.concat(apilan,imglan,aditin),function(e){r.SetPostContent(e.overview),r.SetPostImages(e.images.backdrops),l("#dt_poster").val(e.poster_path),l("#dt_backdrop").val(e.backdrop_path),l("#original_name").val(e.original_name),l("#first_air_date").val(e.first_air_date),l("#last_air_date").val(e.last_air_date),l("#number_of_seasons").val(e.number_of_seasons),l("#number_of_episodes").val(e.number_of_episodes),l("#imdbRating").val(e.vote_average),l("#imdbVotes").val(e.vote_count),l("#episode_run_time").val(e.episode_run_time[0])}),r.ErrorFixedEditor()},r.UpdateEditorSeasons=function(e,t){e=m+"/tv/"+e;apilan="?language="+p,aditin="&api_key="+c,l.getJSON(e.concat(apilan,aditin),function(e){l("#serie").val(e.name),l("#title").val()||(l("label#title-prompt-text").addClass("screen-reader-text"),l("#title").val(r.TitleReplace(dbmovies.titseas,e.name,null,t,null))),l.each(e.seasons,function(e,s){t==s.season_number&&(r.SetPostContent(s.overview),r.ImagePreUpload(s.poster_path),l("#dt_poster").val(s.poster_path),l("#air_date").val(s.air_date))})}),r.ErrorFixedEditor()},r.UpdateEditorEpisodes=function(e,s,t){var a=m+"/tv/"+e;apiuep=m+"/tv/"+e+"/season/"+s+"/episode/"+t,apilan="?language="+p,aditin="&api_key="+c,imglan="&include_image_language="+p,rditin=",null&append_to_response=images&api_key="+c,l.getJSON(a.concat(apilan,aditin),function(e){e=e.name;title=l("#title").val(),l("#serie").val(e),title||(l("label#title-prompt-text").addClass("screen-reader-text"),l("#title").val(r.TitleReplace(dbmovies.titepis,e,null,s,t)))}),l.getJSON(apiuep.concat(apilan,imglan,rditin),function(e){var t;r.SetPostContent(e.overview),r.ImagePreUpload(e.still_path),l("#episode_name").val(e.name),l("#dt_backdrop").val(e.still_path),l("#air_date").val(e.air_date),!l("#imagenes").val()&&e.images.stills&&(t="",l.each(e.images.stills,function(e,s){return!(9<e)&&void(t+=9==e?s.file_path:s.file_path+"\n")}),l("#imagenes").val(t))}),r.ErrorFixedEditor()},r.GenerateEditor=function(){1==l(g).length&&l(document).on("click",g,function(){l("#dbmovies-message").remove(),l("#api_table").addClass("hidden_api"),l("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),n?l.getJSON(i+"/?check="+n,function(e){if(1==e.status&&1<=e.credits||1==e.status&&1==e.unlimited){var s=l("#post_type").val(),t=l("#post_ID").val(),a=l("#ids").val(),o=l("#temporada").val(),i=l("#episodio").val();switch(s){case"movies":case"tvshows":r.AddMainTitle(t,a,s);break;case"seasons":r.AddSeason(t,a,o,s);break;case"episodes":r.AddEpisode(t,a,o,i,s)}}else e.error?r.ErrorNoticeEditor(e.error):r.ErrorNoticeEditor(b)}).fail(function(){r.ErrorNoticeEditor(dbmovies.dbmverr)}):r.ErrorNoticeEditor(dbmovies.misskey)})},r.AddMainTitle=function(e,s,t){s?l.ajax({url:d,type:"POST",dataType:"json",data:{idpost:e,tmdbid:s,typept:t,action:"dbmovies_genereditor"},success:function(e){1==e.response&&window.location.replace(e.editlink),0==e.response&&r.ErrorNoticeEditor(e.message)}}):r.ErrorFixedEditor()},r.AddSeason=function(s,t,a,o){t&&a?l.getJSON(m+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){l.ajax({url:d,type:"POST",dataType:"json",data:{idpost:s,tmdbid:t,typept:o,season:a,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?r.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&r.ErrorNoticeEditor(e.message)}})}).fail(function(){r.ErrorNoticeEditor(dbmovies.tmdberr)}):r.ErrorFixedEditor()},r.AddEpisode=function(s,t,a,o,i){t&&a&&o?l.getJSON(m+"/tv/"+t+"?language="+p+"&api_key="+c,function(e){l.ajax({url:d,type:"POST",dataType:"json",data:{idpost:s,tmdbid:t,typept:i,season:a,episde:o,tvname:e.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?r.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&r.ErrorNoticeEditor(e.message)}})}).fail(function(){r.ErrorNoticeEditor(dbmovies.tmdberr)}):r.ErrorFixedEditor()},r.ErrorNoticeEditor=function(e){l("#postbox-container-2").prepend('<div id="dbmovies-message" class="notice notice-warning"><p>'+e+"</p></div>"),l("#loading_api").html(""),l("#api_table").removeClass("hidden_api")},r.ErrorFixedEditor=function(){l("#loading_api").html(""),l("#api_table").removeClass("hidden_api")},r.NavSettings=function(){var e=r.getCookie("_dbmvs_tabname"),s="#dbmvs-nav-settings > li.nav-tab";1==l("#dbmvs-nav-settings").length&&setTimeout(function(){l("#settab-"+e).trigger("click")},1),l(document).on("click",s,function(){var e=l(this).data("tab");return 0!=e&&(l(s).removeClass("nav-tab-active"),l(".tab-content").removeClass("on"),l(this).addClass("nav-tab-active"),l("#dbmv-setting-"+e).addClass("on"),r.setCookie("_dbmvs_tabname",e,30)),!1})},r.SaveSettings=function(){var s="#dbmvsbtn-savesettings",t="#dbmvsssrespnc";l(document).on("submit","#dbmovies-settings",function(){return l(s).prop("disabled",!0),l(".tab-content").addClass("onprogress"),l.ajax({url:d,type:"POST",dataType:"json",data:l(this).serialize(),success:function(e){n&&1!=e.reload?(l(".tab-content").removeClass("onprogress"),l(t).addClass("fadein"),l(t).html(e.message),setTimeout(function(){l(s).prop("disabled",!1),l(t).html(""),l(t).removeClass("fadein")},1e3)):location.reload()}}),!1})},r.GoTop=function(){var e="#dbmovies-back-top";1==l(e).length&&(l(e).hide(),l(function(){l(window).scroll(function(){200<l(this).scrollTop()?l(e).fadeIn():l(e).fadeOut()}),l(e).click(function(){return l("body,html").animate({scrollTop:0},500),!1})}))},r.LogCollapse=function(){l(document).on("click",".dbmovies-log-collapse",function(){return l(this).toggleClass("expand"),l("#dbmovies-logs-box").toggleClass("expand"),!1})},r.Auth=function(){l.each(["#dbmvs-forms-response","#dbmovies-importer",".dbmovies-tvshow-content-generator"],function(e,s){l(s).length&&(n?(r.ApiRemoteData(!0),setInterval(function(){r.ApiRemoteData(!1)},6e4)):(1==l("#dbmovies-dbmvs-application").length&&window.location.replace("admin.php?page=dbmvs-settings"),r.AuthModules()))}),l(document).on("click",".dbdata",function(){return!1}),l(document).on("click",".dbdata.consultor",function(){return l(".dbdata").removeClass("consultor"),r.ApiRemoteData(!1),setTimeout(function(){l(".dbdata").addClass("consultor")},1e4),!1})},r.ApiRemoteData=function(s){t?l.getJSON(i+"/?check="+n,function(e){"1"==e.status?(l(".dbmvs-credits").show(),l("#dbmvs-credits").html(r.NumberFormat(e.credits)),l("#dbmvs-credits-used").html(r.NumberFormat(e.used_credits)),l("#dbmvs-requests").html(r.NumberFormat(e.requests)),1<=e.credits||1==e.unlimited?1==s&&(l("#dbmvs-logo-status").addClass("ready"),l("#dbmvs-log-indicator").after('<li class="fadein"><span class="type">dbmvs</span>'+dbmovies.welcom+"</li>")):(r.AuthModules(),l("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+b+"</li>"))):(r.AuthModules(),l("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+e.error+"</li>"),l("#dbmvs-logo-status").addClass("flashit error")),l(".dbmovies-logs").show()}):(l("#dbmvs-forms-response").remove(),l(".dbmovies-logs").show(),l("#dbmvs-log-indicator").after('<li class="bounce bigmessage">'+dbmovies.nointrn+"</li>"))},r.AuthModules=function(){l("#dbmvs-forms-response").remove(),l("#dbmovies-importer").remove(),l(".dbmovies-tvshow-content-generator").remove()},r.IMDbUpdater=function(){l(document).on("click","#dbmvs-imdb",function(){var e=parseInt(l(y).val());return l(this).hide(),l("#dbmovies-li-imdb > span.spinner").show(),l("#dbmovies-li-imdb > span.percentage").show(),l.ajax({url:d,type:"POST",dataType:"json",data:{page:e,action:"dbmovies_app_upimdb"},success:function(r){var d=[];1==r.response?(l(y).val(++e),l(".progressing").animate({width:r.prgss+"%"},50,function(){}),l("#dbmovies-li-imdb > span.percentage").html(r.prgss+"%"),l.each(r.imdb,function(e,s){var t=s.imdb,a=s.rating+" - ",o=(s.votes,s.title),i=s.plink,n='<span class="type">'+s.imdb+"</span>",i='<a href="'+i+'">'+o+"</a>",o='<span class="microtime">'+r.mtime+"</span>";t?d.push('<li class="jump">'+n+a+i+o+"</li>"):d.push('<li class="jump"><span class="error">'+s.message+"</span>"+o+"</li>")}),l("#dbmvs-log-indicator").after(d.join("")),setTimeout(function(){l("#dbmvs-imdb").trigger("click")},50)):(l("#dbmovies-li-imdb > span.percentage").hide(),l("#dbmovies-li-imdb > span.spinner").hide(),l("#dbmvs-imdb").show(),l(".progressing").animate({width:"0%"},4e3,function(){}),setTimeout(function(){location.reload()},4500))}}),!1})},r.CodeStarTab=function(){e&&(l(".cs-section").hide(),l(".cs-nav ul a").removeClass("cs-section-active"),l("#tab-"+e).addClass("cs-section-active"),l("#cs-tab-"+e).show())},r.ReubicateForm=function(){var e,s="#dbmvoies-importer-html";1==l(s).length&&(e=l(s).html(),l(".wp-header-end").after(e),l(s).remove())},r.Application=function(){var e=r.getCookie("_dbmvs_tabapp"),s=".dbmvs-tab-content";1==l("#dbmovies-dbmvs-application").length&&setTimeout(function(){l("#dbmvstabapp-"+e).trigger("click")},1),l(document).on("click",s,function(){var e;return l(this).hasClass("button-primary")||(e=l(this).data("type"),l(".genres").removeClass("on"),l("#genres-box-"+e).addClass("on"),l("#dbmvs-filter-type").val(e),l("#dbmvs-search-type").val(e),l(s).removeClass("button-primary"),l(this).addClass("button-primary"),r.FixingApiResults(),r.setCookie("_dbmvs_tabapp",e,30)),!1})},r.Cimport=function(){l.each(["#dbmvs-year","#dbmvs-movies-genres","#dbmvs-tvshows-genres","#dbmvs-filter-type","#dbmvs-popularity","#dbmvs-search-term"],function(e,s){l(document).on("change",s,function(){r.FixingApiResults()})}),l(document).on("click","#bulk-importer",function(){return l("#bulk-importer-click").hide(),l(".cimport").each(function(){var e=l(this),s=e.data("type"),t=e.data("tmdb");return e.hide(),e.removeClass("cimport"),l("#tmdb-"+t).removeClass("fadein"),l("#tmdb-"+t).removeClass("non-existent"),l("#tmdb-"+t).addClass("onload jump"),r.TMDbAppImport(s,t,!0,a),!1}),!1}),l(document).on("click",".cimport",function(){var e=l(this),s=e.data("type"),t=e.data("tmdb");return e.hide(),e.removeClass("cimport"),l("#tmdb-"+t).removeClass("fadein"),l("#tmdb-"+t).removeClass("non-existent"),l("#tmdb-"+t).addClass("onload jump"),r.TMDbAppImport(s,t,!1,!1),!1})},r.FixingApiResults=function(){l("#dbmovies-loadmore").removeClass("search"),l("#dbmovies-loadmore").removeClass("filter"),l("#dbmvs-results-number").html(0),l("#bulk-importer-click").hide(),l("#dbmovies-loadmore").hide(),l("#dbmvs-page").val(1),l("#dbmvs-search-page").val(1),l(".item").remove()},r.TMDbAppImport=function(e,s,t,a){t&&!a&&setTimeout(function(){l("#bulk-importer").trigger("click")},o),l.ajax({url:d,type:"POST",dataType:"json",data:{ptype:e,ptmdb:s,action:"dbmovies_insert_tmdb"},success:function(e){r.ComposeItemLog(e),1==e.response?(l("#tmdb-"+s).removeClass("onload"),l("#tmdb-"+s).removeClass("fadein"),l("#tmdb-"+s).addClass("existent bounce"),a&&l("#bulk-importer").trigger("click")):(l("#tmdb-"+s).removeClass("onload"),l("#tmdb-"+s).addClass("error"),l("#cimprt-"+s).addClass("cimport"),l("#cimprt-"+s).show())}})},r.Search=function(){l(document).on("submit","#dbmovies-form-search",function(){return l("#dbmvs-btn-search").prop("disabled",!0),l("#dbmovies-loadmore").addClass("search disabled"),l("#dbmovies-loadmore").hide(),l("#dbmovies-loadmore-spinner").show(),l.ajax({url:d,type:"POST",dataType:"json",data:l(this).serialize(),success:function(e){var s=parseInt(l("#dbmvs-search-page").val());l("#current-page").val(e.page),l("#current-year").val(e.year),l("#dtotal-items").val(e.items),l("#dbmvs-results-number").html(r.NumberFormat(e.total)),l("#dbmovies-loadmore-spinner").hide(),l("#dbmovies-loadmore").removeClass("disabled"),r.ComposeFilterLog(e),1==e.response&&(s<e.pages?l("#dbmovies-loadmore").show():l("#dbmovies-loadmore").removeClass("search"),l("#dbmvs-btn-search").prop("disabled",!1),r.ComposeResults(e.results)),0==e.response&&r.FixingApiResults()}}),!1})},r.Filter=function(){l("#current-page").val(),l("#current-year").val();l(document).on("submit","#dbmovies-form-filter",function(){return l("#bulk-importer-click").hide(),l("#dbmovies-loadmore").hide(),l("#dbmovies-loadmore").addClass("filter disabled"),l("#dbmvs-btn-filter").prop("disabled",!0),l("#dbmovies-loadmore-spinner").show(),l.ajax({url:d,type:"POST",dataType:"json",data:l(this).serialize(),success:function(e){var s=parseInt(l("#dbmvs-page").val());l("#current-page").val(e.page),l("#current-year").val(e.year),l("#dtotal-items").val(e.items),l("#dbmvs-results-number").html(r.NumberFormat(e.total)),l("#dbmovies-loadmore").removeClass("disabled"),r.ComposeFilterLog(e),l("#dbmovies-loadmore-spinner").hide(),1==e.response&&(s<e.pages&&l("#dbmovies-loadmore").show(),l("#bulk-importer-click").show(),l("#dbmvs-btn-filter").prop("disabled",!1),r.ComposeResults(e.results)),0==e.response&&(alert(e.message),l("#dbmvs-btn-filter").prop("disabled",!1),r.FixingApiResults())}}),!1})},r.ComposeResults=function(e){var o=[];l.each(e,function(e,s){var t,a;l("#tmdb-"+s.id).length||(a="","non-existent"==s.db&&(a='<div id="cimprt-'+s.id+'" class="cimport" data-tmdb="'+s.id+'" data-type="'+s.tp+'"></div>'),t='<div class="image"><img src="'+s.im+'">'+a+"</div>",a='<div class="data"><h3>'+s.ti+"</h3><span>"+s.dt+"</span></div>",o.push('<div class="item fadein"><article class="'+s.db+'" id="tmdb-'+s.id+'">'+t+a+"</article></div>"))}),l("#response-dbmovies").before(o.join(""))},r.ComposeItemLog=function(e){var s,t,a,o="";o=1==e.response?(s='<span class="type green">'+e.status+"</span>",t='<span class="type">'+e.type+"</span>",a='<a href="'+e.permalink+'" target="_blank">'+e.title+"</a>",s+t+('<span class="edit"><a href="'+e.editlink+'" target="_blank">'+dbmovies.editxt+"</a></span>")+a+('<span class="microtime">'+e.mtime+"</span>")):e.message,l("#dbmvs-log-indicator").after('<li class="bounce">'+o+"</li>")},r.ComposeFilterLog=function(e){var s,t,a="";a=1==e.response?(s='<span class="type green">'+e.type+"</span>",t='<span class="microtime">'+e.mtime+"</span>",s+dbmovies.complt+t):e.message,l("#dbmvs-log-indicator").after('<li class="fadein">'+a+"</li>")},r.LoadMore=function(){l.each([".dbmvsloadmore.search",".dbmvsloadmore.filter"],function(e,t){l(document).on("click",t,function(){var e;return".dbmvsloadmore.filter"==t&&(e=parseInt(l("#dbmvs-page").val())),".dbmvsloadmore.search"==t&&(e=parseInt(l("#dbmvs-page").val())),e&&!l(this).hasClass("disabled")&&(".dbmvsloadmore.filter"==t&&(l("#dbmvs-page").val(++e),l("#dbmvs-btn-filter").trigger("click")),".dbmvsloadmore.search"==t&&(l("#dbmvs-search-page").val(++e),l("#dbmvs-btn-search").trigger("click"))),!1}),s&&l(window).scroll(function(){var e=l(this),s=l(".wrapp");l("#dtotal-items").val()<parseInt(v)&&e.scrollTop()>=s.height()-e.height()+240&&(l("#dbmovies-loadmore").hasClass("disabled")||setTimeout(function(){l(t).trigger("click")},500))})})},r.Importer=function(){1==l(_).length&&l(document).on("submit",_,function(){var s="#dbmovies-btn-importer",t="#dbmovies-inp-tmdb";return l(s).prop("disabled",!0),l(t).addClass("disabled"),l(s).val(dbmovies.loading),l(".wp-list-table").addClass("onprogress"),l(_).addClass("onprogress"),l("#dbmovies-loader").addClass("is-active"),l.ajax({url:d,type:"POST",dataType:"json",data:l(this).serialize(),success:function(e){1==e.response?window.location.replace(e.editlink):(alert(e.message),l(s).prop("disabled",!1),l(t).removeClass("disabled"),l(s).val(dbmovies.import),l(_).removeClass("onprogress"),l(".wp-list-table").removeClass("onprogress"),l("#dbmovies-loader").removeClass("is-active"))}}),!1})},r.GeneratorSeasons=function(){var i=l("#ids").val();l(document).on("click","#dbmovies-generator-seprepa",function(){var e=l("#tmdbseasos").val(),s=l("#tmdbsename").val();return l(this).prop("disabled",!0),e||s||l.getJSON(m+"/tv/"+i+"?language="+p+"&api_key="+c,function(e){var s=e.name||e.original_name;l("#tmdbsename").val(s),l.each(e,function(e,s){"number_of_seasons"==e&&(l("#tmdbseasos").val(s),l("#number_of_seasons").val(s),l("#dbmovies-json-response").html("0/"+s)),"number_of_episodes"==e&&l("#number_of_episodes").val(s)}),l("#dbmovies-generator-seprepa").removeClass("button-primary"),l(C).removeClass("button-secundary"),l(C).addClass("button-primary"),l(C).prop("disabled",!1)}),!1}),l(document).on("click",C,function(){var e=parseInt(l("#tmdbseason").val()),s=parseInt(l("#tmdbseasos").val()),t=l("#tmdbsename").val(),a=l("#postparent").val(),o=(e-1)/s*100;return l(this).prop("disabled",!0),l(this).hide(300),l("#dbmovies-loader").addClass("is-active"),r.Progress(o),e<=s?(l("#tmdbseason").val(e+1),l(f).html(e+"/"+s),l.ajax({url:d,type:"POST",dataType:"json",data:{tmdb:i,tmse:e,name:t,post:a,action:"dbmovies_generate_se"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),l(C).prop("disabled",!1),setTimeout(function(){l(C).trigger("click")},75)):location.reload()}})):location.reload(),!1})},r.GeneratorEpisodes=function(){var i=l("#ids").val(),n=l("#temporada").val();l(document).on("click","#dbmovies-generator-epprepa",function(){l("#tmdbepisos").val(),l("#tmdbsename").val();return l(this).prop("disabled",!0),l.getJSON(m+"/tv/"+i+"?language="+p+"&api_key="+c,function(a){l.each(a.seasons,function(e,s){var t;n==s.season_number&&(t=a.name||a.original_name,l("#tmdbsename").val(t),l("#tmdbepisos").val(s.episode_count),l("#dbmovies-json-response").html("0/"+s.episode_count))}),l("#dbmovies-generator-epprepa").removeClass("button-primary"),l(k).removeClass("button-secundary"),l(k).addClass("button-primary"),l(k).prop("disabled",!1),"all"==u&&setTimeout(function(){l(k).trigger("click")},1500)}),!1}),l(document).on("click",k,function(){var e=parseInt(l("#tmdbepisod").val()),s=parseInt(l("#tmdbepisos").val()),t=l("#tmdbsename").val(),a=l("#postparent").val(),o=(e-1)/s*100;return l(this).prop("disabled",!0),l(this).hide(300),l("#dbmovies-loader").addClass("is-active"),r.Progress(o),e<=s?(l("#tmdbepisod").val(e+1),l(f).html(e+"/"+s),l.ajax({url:d,type:"POST",dataType:"json",data:{tmdb:i,tmse:n,tmep:e,name:t,post:a,action:"dbmovies_generate_ep"},success:function(e){1==e.response?(console.log(e.title+" - "+e.mtime),l(k).prop("disabled",!1),setTimeout(function(){l(k).trigger("click")},75)):"all"==u?window.close():location.reload()}})):"all"==u?window.close():location.reload(),!1})},r.Progress=function(e){l("#dbmovies-progress").animate({width:e+"%"},150,function(){})},r.NumberFormat=function(e){x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var s=/(\d+)(\d{3})/;s.test(x1);)x1=x1.replace(s,"$1,$2");return x1+x2},r.setCookie=function(e,s,t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3);a="expires="+a.toUTCString();document.cookie=e+"="+s+";"+a+";path=/"},r.getCookie=function(e){for(var s=e+"=",t=decodeURIComponent(document.cookie).split(";"),a=0;a<t.length;a++){for(var o=t[a];0==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(s))return o.substring(s.length,o.length)}return!1},r.delCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}(jQuery);
